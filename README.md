The code is from
https://www.youtube.com/watch?v=-f1iAsrkyB0&list=PL0Zuz27SZ-6M1J5I1w2-uZx36Qp6qhjKo&index=4
and 
https://www.youtube.com/watch?v=GdOgYQzGexY&list=PL0Zuz27SZ-6M1J5I1w2-uZx36Qp6qhjKo&index=5